{"paragraphs":[{"text":"%md\n## Jeu de donnees\n\nThe Global Database of Events, Language, and Tone (*GDELT*), est une initiative pour construire un catalogue de comportements et de croyances sociales à travers le monde, reliant chaque personne, organisation, lieu, dénombrement, thème, source d'information, et événement à travers la planète en un seul réseau massif qui capture ce qui se passe dans le monde, le contexte, les implications ainsi que la perception des gens sur chaque jour.\n\n\nCette base de données a eu beaucoup d'utilisations, par exemple pour mieux comprendre l'évolution et l'impact de la crise financière du 2008 (https://arxiv.org/pdf/1403.2272v1.pdf[Bayesian dynamic financial networks with time-varying predictors]) ou analyser l'évolution des relations entre des pays impliquées dans des conflits (http://www.gao.ece.ufl.edu/GXU/fun_reading/sbp_hurst.pdf[Massive Media Event Data Analysis to Assess World-Wide Political Conflict and Instability] ).\n\n\nGDELT est compose par trois jeux de fichiers CSV, avec un fichier compressé par tranche de 15 minutes:\n\n* les events (https://bigquery.cloud.google.com/table/gdelt-bq:gdeltv2.events?tab=schema[schema], http://data.gdeltproject.org/documentation/CAMEO.Manual.1.1b3.pdf[CAMEO Ontology], http://data.gdeltproject.org/documentation/GDELT-Event_Codebook-V2.0.pdf[documentation])\n* les mentions (https://bigquery.cloud.google.com/table/gdelt-bq:gdeltv2.eventmentions[schema], http://data.gdeltproject.org/documentation/GDELT-Event_Codebook-V2.0.pdf[documentation])\n* le graph des relations => GKG, Global Knowledge Graph (https://bigquery.cloud.google.com/table/gdelt-bq:gdeltv2.gkg[schema], http://data.gdeltproject.org/documentation/GDELT-Global_Knowledge_Graph_Codebook-V2.1.pdf[documentation])\n\nL'ensemble des données _GDELT_ sont disponibles via HTTP.\nUn fichier CSV _masterfilelist.txt_ (http://data.gdeltproject.org/gdeltv2/masterfilelist.txt[Master CSV data file list]) nous permet d'avoir la liste de tous les fichiers du jeu de données GDELT ainsi que l'URL pour télécharger chaque fichier.\n\n\nPour plus d'infos sur le format des fichiers vous pouvez consulter la documentation GDELT: `https://blog.gdeltproject.org/gdelt-2-0-our-global-world-in-realtime/`\n","user":"anonymous","dateUpdated":"2020-01-22T22:46:24+0000","config":{"tableHide":true,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":false,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1579359387325_1382003950","id":"20181212-100610_115068599","dateCreated":"2020-01-18T14:56:27+0000","dateStarted":"2020-01-22T22:46:24+0000","dateFinished":"2020-01-22T22:46:25+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:14050","results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h2>Jeu de donnees</h2>\n<p>The Global Database of Events, Language, and Tone (*GDELT*), est une initiative pour construire un catalogue de comportements et de croyances sociales à travers le monde, reliant chaque personne, organisation, lieu, dénombrement, thème, source d&rsquo;information, et événement à travers la planète en un seul réseau massif qui capture ce qui se passe dans le monde, le contexte, les implications ainsi que la perception des gens sur chaque jour.</p>\n<p>Cette base de données a eu beaucoup d&rsquo;utilisations, par exemple pour mieux comprendre l&rsquo;évolution et l&rsquo;impact de la crise financière du 2008 (<a href=\"https://arxiv.org/pdf/1403.2272v1.pdf[Bayesian\">https://arxiv.org/pdf/1403.2272v1.pdf[Bayesian</a> dynamic financial networks with time-varying predictors]) ou analyser l&rsquo;évolution des relations entre des pays impliquées dans des conflits (<a href=\"http://www.gao.ece.ufl.edu/GXU/fun_reading/sbp_hurst.pdf[Massive\">http://www.gao.ece.ufl.edu/GXU/fun_reading/sbp_hurst.pdf[Massive</a> Media Event Data Analysis to Assess World-Wide Political Conflict and Instability] ).</p>\n<p>GDELT est compose par trois jeux de fichiers CSV, avec un fichier compressé par tranche de 15 minutes:</p>\n<ul>\n  <li>les events (<a href=\"https://bigquery.cloud.google.com/table/gdelt-bq:gdeltv2.events?tab=schema[schema]\">https://bigquery.cloud.google.com/table/gdelt-bq:gdeltv2.events?tab=schema[schema]</a>, <a href=\"http://data.gdeltproject.org/documentation/CAMEO.Manual.1.1b3.pdf[CAMEO\">http://data.gdeltproject.org/documentation/CAMEO.Manual.1.1b3.pdf[CAMEO</a> Ontology], <a href=\"http://data.gdeltproject.org/documentation/GDELT-Event_Codebook-V2.0.pdf[documentation]\">http://data.gdeltproject.org/documentation/GDELT-Event_Codebook-V2.0.pdf[documentation]</a>)</li>\n  <li>les mentions (<a href=\"https://bigquery.cloud.google.com/table/gdelt-bq:gdeltv2.eventmentions[schema]\">https://bigquery.cloud.google.com/table/gdelt-bq:gdeltv2.eventmentions[schema]</a>, <a href=\"http://data.gdeltproject.org/documentation/GDELT-Event_Codebook-V2.0.pdf[documentation]\">http://data.gdeltproject.org/documentation/GDELT-Event_Codebook-V2.0.pdf[documentation]</a>)</li>\n  <li>le graph des relations =&gt; GKG, Global Knowledge Graph (<a href=\"https://bigquery.cloud.google.com/table/gdelt-bq:gdeltv2.gkg[schema]\">https://bigquery.cloud.google.com/table/gdelt-bq:gdeltv2.gkg[schema]</a>, <a href=\"http://data.gdeltproject.org/documentation/GDELT-Global_Knowledge_Graph_Codebook-V2.1.pdf[documentation]\">http://data.gdeltproject.org/documentation/GDELT-Global_Knowledge_Graph_Codebook-V2.1.pdf[documentation]</a>)</li>\n</ul>\n<p>L&rsquo;ensemble des données <em>GDELT</em> sont disponibles via HTTP.<br/>Un fichier CSV <em>masterfilelist.txt</em> (<a href=\"http://data.gdeltproject.org/gdeltv2/masterfilelist.txt[Master\">http://data.gdeltproject.org/gdeltv2/masterfilelist.txt[Master</a> CSV data file list]) nous permet d&rsquo;avoir la liste de tous les fichiers du jeu de données GDELT ainsi que l&rsquo;URL pour télécharger chaque fichier.</p>\n<p>Pour plus d&rsquo;infos sur le format des fichiers vous pouvez consulter la documentation GDELT: <code>https://blog.gdeltproject.org/gdelt-2-0-our-global-world-in-realtime/</code></p>\n</div>"}]}},{"text":"%md\n\nDans ce notebook nous téléchargeons les fichiers GDELT pour les journées du 1er et 2 décembre 2019.\nOn commence par definir une fonction `fileDownloader` qui télécharge un fichier à partir d’une URL.","user":"anonymous","dateUpdated":"2020-01-22T22:46:25+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/markdown"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1579725035069_1496177521","id":"20200122-203035_2083105199","dateCreated":"2020-01-22T20:30:35+0000","dateStarted":"2020-01-22T22:46:25+0000","dateFinished":"2020-01-22T22:46:25+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:14051","results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<p>Dans ce notebook nous téléchargeons les fichiers GDELT pour les journées du 1er et 2 décembre 2019.<br/>On commence par definir une fonction <code>fileDownloader</code> qui télécharge un fichier à partir d’une URL.</p>\n</div>"}]}},{"text":"import sys.process._\nimport java.net.URL\nimport java.io.File\nimport java.nio.file.{Files, StandardCopyOption}\nimport java.net.HttpURLConnection \nimport org.apache.spark.sql.functions._\n\n\ndef fileDownloader(urlOfFileToDownload: String, fileName: String) = {\n    val url = new URL(urlOfFileToDownload)\n    val connection = url.openConnection().asInstanceOf[HttpURLConnection]\n    connection.setConnectTimeout(5000)\n    connection.setReadTimeout(5000)\n    connection.connect()\n\n    if (connection.getResponseCode >= 400)\n        println(\"error\")\n    else\n        url #> new File(fileName) !!\n}","user":"anonymous","dateUpdated":"2020-01-22T22:46:25+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1579359387331_-1648212035","id":"20181209-161931_737140067","dateCreated":"2020-01-18T14:56:27+0000","dateStarted":"2020-01-22T22:46:25+0000","dateFinished":"2020-01-22T22:46:26+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:14052","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"warning: there was one feature warning; re-run with -feature for details\nimport sys.process._\nimport java.net.URL\nimport java.io.File\nimport java.nio.file.{Files, StandardCopyOption}\nimport java.net.HttpURLConnection\nimport org.apache.spark.sql.functions._\nfileDownloader: (urlOfFileToDownload: String, fileName: String)Any\n"}]}},{"text":"// input parameters\n\n// Temporary folder (keep / at the end)\nval pathToTmp = \"/tmp/gdelt/\"\n\n// path to the .csv files (keep / at the end)\nval pathToRawData = \"/tmp/gdelt/data/\"\n\n// Date selector (regexp)\nval datePattern = \"/2019120[1-2]\"\n","user":"anonymous","dateUpdated":"2020-01-22T22:55:12+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1579731834424_566447226","id":"20200122-222354_1436144253","dateCreated":"2020-01-22T22:23:54+0000","dateStarted":"2020-01-22T22:46:26+0000","dateFinished":"2020-01-22T22:46:26+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:14053","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"pathToTmp: String = /tmp/gdelt/\npathToRawData: String = /tmp/gdelt/data/\ndatePattern: String = /2019120[1-2]\n"}]}},{"text":"%sh\nmkdir /tmp\nmkdir /tmp/gdelt\nls -l /tmp/gdelt\n","user":"anonymous","dateUpdated":"2020-01-22T23:08:12+0000","config":{"editorSetting":{"language":"sh","editOnDblClick":false,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/sh","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1579359387336_1751457891","id":"20200109-205355_820837842","dateCreated":"2020-01-18T14:56:27+0000","dateStarted":"2020-01-22T23:08:12+0000","dateFinished":"2020-01-22T23:08:12+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:14054","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"mkdir: cannot create directory ‘/tmp’: File exists\nmkdir: cannot create directory ‘/tmp/gdelt’: File exists\ntotal 111400\ndrwxr-xr-x 2 1000 1000   196608 Jan 22 22:55 data\n-rw-r--r-- 1 1000 1000 59103292 Jan 22 22:46 masterfilelist-translation.txt\n-rw-r--r-- 1 1000 1000 54713872 Jan 22 22:46 masterfilelist.txt\ndrwxr-xr-x 5 1000 1000     4096 Jan 20 18:22 spark\ndrwxr-xr-x 2 root root    45056 Jan 22 23:04 sparkrequest1\n"}]}},{"text":"%md\n\nNous téléchargeons en local les fichiers `masterfilelist.txt` et  `masterfilelist_translation.txt` de GDELT.","user":"anonymous","dateUpdated":"2020-01-22T22:46:27+0000","config":{"tableHide":true,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":false,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1579359387337_467064725","id":"20181212-101024_1671681559","dateCreated":"2020-01-18T14:56:27+0000","dateStarted":"2020-01-22T22:46:27+0000","dateFinished":"2020-01-22T22:46:27+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:14055","results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<p>Nous téléchargeons en local les fichiers <code>masterfilelist.txt</code> et <code>masterfilelist_translation.txt</code> de GDELT.</p>\n</div>"}]}},{"text":"// save the list of files\nfileDownloader(\"http://data.gdeltproject.org/gdeltv2/masterfilelist.txt\",\n               pathToTmp + \"masterfilelist.txt\") \nfileDownloader(\"http://data.gdeltproject.org/gdeltv2/masterfilelist-translation.txt\",\n               pathToTmp + \"masterfilelist-translation.txt\")","user":"anonymous","dateUpdated":"2020-01-22T22:46:27+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1579359387337_-1630520763","id":"20181209-162121_1695304399","dateCreated":"2020-01-18T14:56:27+0000","dateStarted":"2020-01-22T22:46:27+0000","dateFinished":"2020-01-22T22:46:37+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:14056","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"res36: Any = \"\"\n"}]}},{"text":"%md\nNous vérifions que les fichiers ont été téléchargés correctement.","user":"anonymous","dateUpdated":"2020-01-22T22:46:37+0000","config":{"tableHide":true,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":false,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1579359387338_1132021883","id":"20181212-101108_352331024","dateCreated":"2020-01-18T14:56:27+0000","dateStarted":"2020-01-22T22:46:37+0000","dateFinished":"2020-01-22T22:46:37+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:14057","results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<p>Nous vérifions que les fichiers ont été téléchargés correctement.</p>\n</div>"}]}},{"text":"%sh\nmkdir /tmp/gdelt/data\nls -lrth /tmp/gdelt","user":"anonymous","dateUpdated":"2020-01-22T22:46:37+0000","config":{"editorSetting":{"language":"sh","editOnDblClick":false,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/sh","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1579359387339_-423671480","id":"20181210-111357_801203770","dateCreated":"2020-01-18T14:56:27+0000","dateStarted":"2020-01-22T22:46:37+0000","dateFinished":"2020-01-22T22:46:37+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:14058","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"mkdir: cannot create directory ‘/tmp/gdelt/data’: File exists\ntotal 109M\ndrwxr-xr-x 5 1000 1000 4.0K Jan 20 18:22 spark\ndrwxr-xr-x 2 1000 1000 192K Jan 22 22:37 data\n-rw-r--r-- 1 1000 1000  53M Jan 22 22:46 masterfilelist.txt\n-rw-r--r-- 1 1000 1000  57M Jan 22 22:46 masterfilelist-translation.txt\n"}]}},{"text":"import org.apache.spark.sql.SQLContext\n\nval sqlContext = new SQLContext(sc)\nval dfFilelistEng = sqlContext\n    .read\n    .option(\"delimiter\", \" \")\n    .option(\"infer_schema\", \"true\")\n    .csv(pathToTmp + \"masterfilelist.txt\")\n    .withColumnRenamed(\"_c0\",\"size\")\n    .withColumnRenamed(\"_c1\",\"hash\")\n    .withColumnRenamed(\"_c2\",\"url\")\n    .cache\n\nval dfFilelistTrans = sqlContext\n    .read\n    .option(\"delimiter\", \" \")\n    .option(\"infer_schema\", \"true\")\n    .csv(pathToTmp + \"masterfilelist-translation.txt\")\n    .withColumnRenamed(\"_c0\",\"size\")\n    .withColumnRenamed(\"_c1\",\"hash\")\n    .withColumnRenamed(\"_c2\",\"url\")\n    .cache\n\ndfFilelistEng.show(false)","user":"anonymous","dateUpdated":"2020-01-22T22:46:37+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://172.17.0.2:4040/jobs/job?id=27","http://172.17.0.2:4040/jobs/job?id=28","http://172.17.0.2:4040/jobs/job?id=29"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1579359387340_251375038","id":"20181209-163052_14263535","dateCreated":"2020-01-18T14:56:27+0000","dateStarted":"2020-01-22T22:46:37+0000","dateFinished":"2020-01-22T22:46:38+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:14059","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"warning: there was one deprecation warning; re-run with -deprecation for details\n+--------+--------------------------------+--------------------------------------------------------------------+\n|size    |hash                            |url                                                                 |\n+--------+--------------------------------+--------------------------------------------------------------------+\n|150383  |297a16b493de7cf6ca809a7cc31d0b93|http://data.gdeltproject.org/gdeltv2/20150218230000.export.CSV.zip  |\n|318084  |bb27f78ba45f69a17ea6ed7755e9f8ff|http://data.gdeltproject.org/gdeltv2/20150218230000.mentions.CSV.zip|\n|10768507|ea8dde0beb0ba98810a92db068c0ce99|http://data.gdeltproject.org/gdeltv2/20150218230000.gkg.csv.zip     |\n|149211  |2a91041d7e72b0fc6a629e2ff867b240|http://data.gdeltproject.org/gdeltv2/20150218231500.export.CSV.zip  |\n|339037  |dec3f427076b716a8112b9086c342523|http://data.gdeltproject.org/gdeltv2/20150218231500.mentions.CSV.zip|\n|10269336|2f1a504a3c4558694ade0442e9a5ae6f|http://data.gdeltproject.org/gdeltv2/20150218231500.gkg.csv.zip     |\n|149723  |12268e821823aae2da90882621feda18|http://data.gdeltproject.org/gdeltv2/20150218233000.export.CSV.zip  |\n|357229  |744acad14559f2781a8db67715d63872|http://data.gdeltproject.org/gdeltv2/20150218233000.mentions.CSV.zip|\n|11279827|66b03e2efd7d51dabf916b1666910053|http://data.gdeltproject.org/gdeltv2/20150218233000.gkg.csv.zip     |\n|158842  |a5298ce3c6df1a8a759c61b5c0b6f8bb|http://data.gdeltproject.org/gdeltv2/20150218234500.export.CSV.zip  |\n|374528  |dd322c888f28311aca2c735468405551|http://data.gdeltproject.org/gdeltv2/20150218234500.mentions.CSV.zip|\n|11212939|cd20f295649b214dd16666ca451b9994|http://data.gdeltproject.org/gdeltv2/20150218234500.gkg.csv.zip     |\n|362610  |c4268d558bb22c02b3c132c17818c68b|http://data.gdeltproject.org/gdeltv2/20150219000000.export.CSV.zip  |\n|287807  |e7f464a7a451ad2af6e9c8fa24f0ccea|http://data.gdeltproject.org/gdeltv2/20150219000000.mentions.CSV.zip|\n|9728953 |8f4b26e134bd6605cce2d32e92e5d3d7|http://data.gdeltproject.org/gdeltv2/20150219000000.gkg.csv.zip     |\n|251605  |7685a6c71f010918f3be0d4ed2be977e|http://data.gdeltproject.org/gdeltv2/20150219001500.export.CSV.zip  |\n|263793  |e23ee65a60a1577dc74b979a54da406e|http://data.gdeltproject.org/gdeltv2/20150219001500.mentions.CSV.zip|\n|9459370 |6031464dfdcb331551d491916d400c18|http://data.gdeltproject.org/gdeltv2/20150219001500.gkg.csv.zip     |\n|255259  |f41066efb05d4024fca9dc1c2c6b9112|http://data.gdeltproject.org/gdeltv2/20150219003000.export.CSV.zip  |\n|308019  |061133d1efd29c66c7ecba0d52063927|http://data.gdeltproject.org/gdeltv2/20150219003000.mentions.CSV.zip|\n+--------+--------------------------------+--------------------------------------------------------------------+\nonly showing top 20 rows\n\nimport org.apache.spark.sql.SQLContext\nsqlContext: org.apache.spark.sql.SQLContext = org.apache.spark.sql.SQLContext@586b98c8\ndfFilelistEng: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] = [size: string, hash: string ... 1 more field]\ndfFilelistTrans: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] = [size: string, hash: string ... 1 more field]\n"}]}},{"text":"val dfSampleEng = dfFilelistEng\n    .filter($\"url\".rlike(datePattern))\n    .cache\n\nval dfSampleTrans = dfFilelistTrans\n    .filter($\"url\".rlike(datePattern))\n    .cache","user":"anonymous","dateUpdated":"2020-01-22T22:46:38+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1579364080503_581852495","id":"20200118-161440_971285278","dateCreated":"2020-01-18T16:14:40+0000","dateStarted":"2020-01-22T22:46:38+0000","dateFinished":"2020-01-22T22:46:38+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:14060","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"dfSampleEng: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] = [size: string, hash: string ... 1 more field]\ndfSampleTrans: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] = [size: string, hash: string ... 1 more field]\n"}]}},{"text":"%md\n\nNous chargeons tous les fichiers sélectionnés localement via un ETL Spark:","user":"anonymous","dateUpdated":"2020-01-22T22:46:39+0000","config":{"tableHide":true,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":false,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1579359387343_2059751635","id":"20181212-101426_1390220831","dateCreated":"2020-01-18T14:56:27+0000","dateStarted":"2020-01-22T22:46:39+0000","dateFinished":"2020-01-22T22:46:39+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:14061","results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<p>Nous chargeons tous les fichiers sélectionnés localement via un ETL Spark:</p>\n</div>"}]}},{"text":"dfSampleEng.select(\"url\").repartition(100).foreach( r=> {\n            val URL = r.getAs[String](0)\n            val fileName = r.getAs[String](0).split(\"/\").last\n            val dir = pathToRawData\n            val localFileName = dir + fileName\n            fileDownloader(URL,  localFileName)\n})\n\ndfSampleTrans.select(\"url\").repartition(100).foreach( r=> {\n            val URL = r.getAs[String](0)\n            val fileName = r.getAs[String](0).split(\"/\").last\n            val dir = pathToRawData\n            val localFileName = dir + fileName\n            fileDownloader(URL, localFileName)\n})","user":"anonymous","dateUpdated":"2020-01-22T22:46:39+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://172.17.0.2:4040/jobs/job?id=30","http://172.17.0.2:4040/jobs/job?id=31"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1579359387345_492176006","id":"20181209-163933_1336720866","dateCreated":"2020-01-18T14:56:27+0000","dateStarted":"2020-01-22T22:46:39+0000","dateFinished":"2020-01-22T22:55:11+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:14062","results":{"code":"SUCCESS","msg":[]}},{"user":"anonymous","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1579732205616_1312286682","id":"20200122-223005_17291846","dateCreated":"2020-01-22T22:30:05+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:14063","dateUpdated":"2020-01-22T22:55:11+0000"}],"name":"gdeltETLLocal","id":"2EXRGV579","noteParams":{},"noteForms":{},"angularObjects":{"md:shared_process":[],"sh:shared_process":[],"spark:shared_process":[],"cassandra:shared_process":[]},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{}}